<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¨Ø§ÙˆÙˆ Ù…Ø§Ø±ÙƒØª - Ø¥ØµØ¯Ø§Ø± Ù…Ø­Ø³Ù‘Ù†</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --gold:#f1c40f;
      --dark:#0b0f14;
      --muted:#131923;
      --accent:#3b82f6;
    }
    body{
      background:linear-gradient(180deg,#0b0f14,#101725 60%,#0b0f14);
      min-height:100vh;
    }
    .glass{
      backdrop-filter: blur(12px);
      background: rgba(255,255,255,0.05);
    }
    .gold{color:var(--gold)}
    .gold-bg{background:linear-gradient(135deg,#f8d14a,#eab308)}
    .card{
      border:1px solid rgba(255,255,255,.08);
      box-shadow: 0 8px 32px rgba(0,0,0,.3);
      transition: all 0.3s ease;
    }
    .card:hover{
      box-shadow: 0 12px 40px rgba(241,196,15,.15);
      border-color: rgba(255,255,255,.12);
    }
    .btn{
      background:linear-gradient(135deg,#f8d14a,#eab308);
      color:#000;
      font-weight:700;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .btn:hover{
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(241,196,15,.4);
    }
    .btn:active{transform: translateY(0)}
    .btn:disabled{filter:grayscale(1); opacity:.6}
    .btn-secondary{
      background: rgba(59,130,246,.2);
      color: #60a5fa;
      border: 1px solid rgba(59,130,246,.3);
    }
    .btn-danger{
      background: rgba(239,68,68,.2);
      color: #f87171;
      border: 1px solid rgba(239,68,68,.3);
    }
    .sidebar a{
      transition: all 0.2s ease;
    }
    .sidebar a.active{
      background: rgba(241,196,15,.14);
      color:#fff;
      border-right: 3px solid var(--gold);
    }
    .sidebar a:hover{
      background: rgba(255,255,255,.08);
    }
    .input-field{
      background: #0e1522;
      border: 1px solid rgba(255,255,255,.1);
      transition: all 0.3s ease;
    }
    .input-field:focus{
      outline: none;
      border-color: var(--gold);
      box-shadow: 0 0 0 3px rgba(241,196,15,.1);
    }
    .tbl th,.tbl td{
      border-bottom:1px solid rgba(255,255,255,.06);
      padding: 12px 8px;
    }
    .tbl th{
      background: rgba(255,255,255,.02);
      font-weight: 600;
    }
    .tbl tr:hover{
      background: rgba(255,255,255,.02);
    }
    ::-webkit-scrollbar{height:10px; width:10px}
    ::-webkit-scrollbar-track{background: #0e1522}
    ::-webkit-scrollbar-thumb{background:#243047; border-radius:12px}
    ::-webkit-scrollbar-thumb:hover{background:#2d3a52}
    .toast{
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      padding: 12px 24px;
      border-radius: 12px;
      font-weight: 600;
      z-index: 1000;
      transition: transform 0.3s ease;
    }
    .toast.show{transform: translateX(-50%) translateY(0)}
    .toast.success{background: rgba(34,197,94,.2); border: 1px solid rgba(34,197,94,.4); color: #4ade80}
    .toast.error{background: rgba(239,68,68,.2); border: 1px solid rgba(239,68,68,.4); color: #f87171}
    .stat-card{
      background: linear-gradient(135deg, rgba(59,130,246,.1), rgba(147,51,234,.1));
      border: 1px solid rgba(147,51,234,.2);
    }
    .mobile-menu{
      transform: translateX(100%);
      transition: transform 0.3s ease;
    }
    .mobile-menu.open{
      transform: translateX(0);
    }
    @keyframes pulse{
      0%, 100%{opacity: 1}
      50%{opacity: 0.5}
    }
    .loading{animation: pulse 2s infinite}
  </style>
</head>
<body class="text-white">
  <!-- Toast Notification -->
  <div id="toast" class="toast"></div>

  <!-- Auth Gate -->
  <div id="auth" class="fixed inset-0 grid place-items-center p-4 z-50" style="background:radial-gradient(1000px 600px at 50% -50%,rgba(241,196,15,.15),transparent), #0b0f14;">
    <div class="glass card max-w-md w-full p-8 rounded-2xl">
      <div class="text-center mb-6">
        <div class="inline-block p-4 rounded-2xl gold-bg mb-4">
          <span class="text-4xl">ğŸ”</span>
        </div>
        <h1 class="text-3xl font-extrabold mb-2">Ø¯Ø®ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
        <p class="text-sm opacity-75">Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ø´Ø±Ù</p>
      </div>
      <label class="block text-sm mb-2 font-semibold">ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</label>
      <input id="pwd" type="password" class="w-full px-4 py-3 rounded-xl input-field" placeholder="********"/>
      <div class="flex items-center justify-between mt-4">
        <label class="flex items-center gap-2 text-sm opacity-80 cursor-pointer">
          <input id="remember" type="checkbox" class="w-4 h-4"/>
          <span>ØªØ°ÙƒØ±Ù†ÙŠ</span>
        </label>
        <button id="loginBtn" class="btn px-6 py-3 rounded-xl">Ø¯Ø®ÙˆÙ„ â†</button>
      </div>
      <div class="mt-4 p-3 rounded-xl bg-blue-500/10 border border-blue-500/20">
        <p class="text-xs opacity-80">ğŸ’¡ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©: <span class="font-mono bg-white/10 px-2 py-1 rounded">bawou-2025</span></p>
      </div>
    </div>
  </div>

  <!-- Mobile Menu Button -->
  <button id="mobileMenuBtn" class="md:hidden fixed top-4 right-4 z-40 p-3 rounded-xl glass card">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
    </svg>
  </button>

  <!-- Layout -->
  <div class="min-h-screen flex">
    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar w-72 fixed md:static inset-y-0 right-0 z-30 mobile-menu md:transform-none p-4 space-y-3 bg-[#0b1120] border-l border-white/10">
      <div class="flex items-center gap-3 p-4 rounded-xl glass card">
        <div class="w-12 h-12 rounded-xl gold-bg grid place-items-center font-black text-xl">B</div>
        <div>
          <div class="font-bold text-lg">Bawou Admin</div>
          <div class="text-xs opacity-70">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø´Ø§Ù…Ù„Ø©</div>
        </div>
      </div>
      
      <nav class="space-y-2 text-sm">
        <a data-route="home" class="flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 cursor-pointer">
          <span class="text-xl">ğŸ </span>
          <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </a>
        <a data-route="branches" class="flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 cursor-pointer">
          <span class="text-xl">ğŸ›ï¸</span>
          <span>Ø§Ù„Ø£Ø±ÙƒØ§Ù†</span>
        </a>
        <a data-route="prices" class="flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 cursor-pointer">
          <span class="text-xl">ğŸ’°</span>
          <span>Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</span>
        </a>
        <a data-route="media" class="flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 cursor-pointer">
          <span class="text-xl">ğŸ–¼ï¸</span>
          <span>Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ø´Ø¹Ø§Ø±Ø§Øª</span>
        </a>
        <a data-route="analytics" class="flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 cursor-pointer">
          <span class="text-xl">ğŸ“Š</span>
          <span>Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</span>
        </a>
        <a data-route="settings" class="flex items-center gap-3 p-3 rounded-xl hover:bg-white/5 cursor-pointer">
          <span class="text-xl">âš™ï¸</span>
          <span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
        </a>
      </nav>
      
      <div class="pt-4 space-y-2">
        <button id="exportBtn" class="w-full btn py-3 rounded-xl flex items-center justify-center gap-2">
          <span>â¬‡ï¸</span>
          <span>ØªØµØ¯ÙŠØ± Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</span>
        </button>
        <label class="block">
          <span class="text-xs opacity-80 mb-1 block">â¬†ï¸ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù„Ù JSON</span>
          <input id="importFile" type="file" accept="application/json" class="block w-full text-xs opacity-70"/>
        </label>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-4 md:p-8 space-y-6">
      <!-- Topbar -->
      <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
        <div>
          <h2 class="text-3xl font-extrabold gold mb-1">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
          <p class="text-sm opacity-70">ØªØ­ÙƒÙ… ÙƒØ§Ù…Ù„ Ø¨Ø§Ù„Ù…Ø­ØªÙˆÙ‰ â€” Ø¨Ø¯ÙˆÙ† Ù„Ù…Ø³ Ø§Ù„ÙƒÙˆØ¯</p>
        </div>
        <div class="flex items-center gap-3 w-full md:w-auto">
          <a href="/" target="_blank" class="flex-1 md:flex-initial px-4 py-2 rounded-xl glass border border-white/10 hover:bg-white/10 text-center">
            ğŸŒ Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆÙ‚Ø¹
          </a>
          <button id="saveAll" class="flex-1 md:flex-initial btn px-6 py-3 rounded-xl flex items-center justify-center gap-2">
            <span>ğŸ’¾</span>
            <span>Ø­ÙØ¸ Ø§Ù„ÙƒÙ„</span>
          </button>
        </div>
      </div>

      <!-- Stats Overview -->
      <div id="statsOverview" class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="stat-card rounded-2xl p-4">
          <div class="text-xs opacity-70 mb-1">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø±ÙƒØ§Ù†</div>
          <div class="text-3xl font-extrabold" id="stat-branches">0</div>
        </div>
        <div class="stat-card rounded-2xl p-4">
          <div class="text-xs opacity-70 mb-1">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
          <div class="text-3xl font-extrabold" id="stat-products">0</div>
        </div>
        <div class="stat-card rounded-2xl p-4">
          <div class="text-xs opacity-70 mb-1">Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø©</div>
          <div class="text-3xl font-extrabold" id="stat-media">0</div>
        </div>
        <div class="stat-card rounded-2xl p-4">
          <div class="text-xs opacity-70 mb-1">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«</div>
          <div class="text-sm font-bold" id="stat-updated">â€”</div>
        </div>
      </div>

      <!-- Router Views -->
      <section id="view-home" class="view space-y-4">
        <div class="grid md:grid-cols-2 gap-4">
          <div class="card glass rounded-2xl p-6">
            <h3 class="font-bold mb-4 text-lg flex items-center gap-2">
              <span>âœ¨</span>
              <span>Ù†Øµ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
            </h3>
            <label class="text-sm opacity-80 block mb-2">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ¨ÙŠØ±</label>
            <input id="hero_title" class="w-full mb-3 px-4 py-3 rounded-xl input-field" placeholder="Ù…Ù†Ø¸ÙˆÙ…Ø© Bawou Market â€” Ø§Ù„Ø¨ÙŠØª Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ Ø§Ù„ÙØ§Ø®Ø±">
            <label class="text-sm opacity-80 block mb-2">ÙˆØµÙ Ù‚ØµÙŠØ±</label>
            <textarea id="hero_desc" rows="4" class="w-full px-4 py-3 rounded-xl input-field"></textarea>
          </div>
          
          <div class="card glass rounded-2xl p-6">
            <h3 class="font-bold mb-4 text-lg flex items-center gap-2">
              <span>ğŸ”˜</span>
              <span>Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¹Ø±Ø¶</span>
            </h3>
            <div class="space-y-3">
              <div>
                <label class="text-sm opacity-80 block mb-1">Ø²Ø± 1 â€“ Ù†Øµ</label>
                <input id="cta1_text" class="w-full mb-2 px-4 py-2 rounded-xl input-field" placeholder="Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø£Ø±ÙƒØ§Ù†">
                <label class="text-sm opacity-80 block mb-1">Ø±Ø§Ø¨Ø·</label>
                <input id="cta1_link" class="w-full px-4 py-2 rounded-xl input-field" placeholder="#branches">
              </div>
              <div>
                <label class="text-sm opacity-80 block mb-1">Ø²Ø± 2 â€“ Ù†Øµ</label>
                <input id="cta2_text" class="w-full mb-2 px-4 py-2 rounded-xl input-field" placeholder="Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø¹Ø±ÙˆØ¶">
                <label class="text-sm opacity-80 block mb-1">Ø±Ø§Ø¨Ø·</label>
                <input id="cta2_link" class="w-full px-4 py-2 rounded-xl input-field" placeholder="#offers">
              </div>
            </div>
          </div>
        </div>

        <div class="card glass rounded-2xl p-6">
          <h3 class="font-bold mb-4 text-lg flex items-center gap-2">
            <span>ğŸ‡©ğŸ‡¿</span>
            <span>Ø´Ø¹Ø§Ø± "ØµÙ†Ø¹ Ø¨ÙØ®Ø± ÙÙŠ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±"</span>
          </h3>
          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <label class="text-sm opacity-80 block mb-2">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø´Ø¹Ø§Ø±</label>
              <select id="madein_dz" class="w-full px-4 py-3 rounded-xl input-field">
                <option value="true">Ù†Ø¹Ù… âœ“</option>
                <option value="false">Ù„Ø§ âœ—</option>
              </select>
            </div>
            <div>
              <label class="text-sm opacity-80 block mb-2">Ù†Øµ Ø§Ù„Ø´Ø¹Ø§Ø±</label>
              <input id="madein_text" class="w-full px-4 py-3 rounded-xl input-field" placeholder="ØµÙ†Ø¹ Ø¨ÙØ®Ø± ÙÙŠ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± ğŸ‡©ğŸ‡¿">
            </div>
          </div>
        </div>
      </section>

      <section id="view-branches" class="view hidden">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-2xl font-bold">Ø§Ù„Ø£Ø±ÙƒØ§Ù† (Cards)</h3>
          <button id="addBranch" class="btn px-5 py-3 rounded-xl flex items-center gap-2">
            <span>â•</span>
            <span>Ø¥Ø¶Ø§ÙØ© Ø±ÙƒÙ†</span>
          </button>
        </div>
        <div id="branchesList" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
      </section>

      <section id="view-prices" class="view hidden">
        <div class="card glass rounded-2xl p-6">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-xl font-bold">Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</h3>
            <button id="addPrice" class="btn px-5 py-3 rounded-xl flex items-center gap-2">
              <span>â•</span>
              <span>Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</span>
            </button>
          </div>
          <div class="overflow-x-auto">
            <table class="tbl w-full text-sm">
              <thead class="opacity-70">
                <tr>
                  <th class="text-right">Ø§Ù„ÙØ±Ø¹</th>
                  <th class="text-right">Ø§Ù„Ù…Ù†ØªØ¬</th>
                  <th class="text-right">Ø§Ù„Ø³Ø¹Ø± (USD)</th>
                  <th class="text-right">Ù…Ù„Ø§Ø­Ø¸Ø©</th>
                  <th class="text-center">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
              </thead>
              <tbody id="priceRows"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section id="view-media" class="view hidden space-y-4">
        <div class="grid md:grid-cols-2 gap-4">
          <div class="card glass rounded-2xl p-6">
            <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
              <span>ğŸ“¤</span>
              <span>Ø±ÙØ¹ Ø´Ø¹Ø§Ø±/ØµÙˆØ±Ø©</span>
            </h3>
            <div class="border-2 border-dashed border-white/20 rounded-xl p-6 text-center hover:border-gold/50 transition-colors cursor-pointer" id="dropZone">
              <input id="imageInput" type="file" accept="image/*" class="hidden"/>
              <div class="text-4xl mb-2">ğŸ“¸</div>
              <p class="text-sm opacity-70">Ø§Ø¶ØºØ· Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ø§Ù„ØµÙˆØ±Ø© Ù‡Ù†Ø§</p>
            </div>
            <div class="mt-4">
              <img id="preview" class="hidden w-full aspect-video object-cover rounded-xl border border-white/10"/>
            </div>
            <div class="mt-4 p-3 rounded-xl bg-blue-500/10 border border-blue-500/20">
              <p class="text-xs opacity-80">ğŸ’¡ ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„ØµÙˆØ± Ù…Ø­Ù„ÙŠÙ‹Ø§ (Base64). Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Firebase StorageØŒ ÙØ¹Ù‘Ù„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª.</p>
            </div>
          </div>
          
          <div class="card glass rounded-2xl p-6">
            <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
              <span>ğŸ–¼ï¸</span>
              <span>Ù…ÙƒØªØ¨Ø© Ø§Ù„ØµÙˆØ± (<span id="mediaCount">0</span>)</span>
            </h3>
            <div id="mediaGrid" class="grid grid-cols-3 gap-3 max-h-96 overflow-y-auto"></div>
          </div>
        </div>
      </section>

      <section id="view-analytics" class="view hidden space-y-4">
        <div class="grid lg:grid-cols-2 gap-4">
          <div class="card glass rounded-2xl p-6">
            <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
              <span>ğŸ“ˆ</span>
              <span>Google Analytics (GA4)</span>
            </h3>
            <p class="text-sm opacity-80 mb-3">ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¶Ù…ÙŠÙ† Ù„ÙˆØ­Ø© Looker Studio Ù‡Ù†Ø§. Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ Embed:</p>
            <input id="looker_embed" class="w-full px-4 py-3 rounded-xl input-field mb-3" placeholder="https://lookerstudio.google.com/embed/reporting/..."/>
            <button id="loadEmbed" class="btn-secondary px-4 py-2 rounded-xl w-full">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ÙˆØ­Ø©</button>
            <div id="embedWrap" class="mt-4 hidden">
              <iframe id="embedFrame" class="w-full h-[420px] rounded-xl border border-white/10"></iframe>
            </div>
          </div>
          
          <div class="card glass rounded-2xl p-6">
            <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
              <span>ğŸ“Š</span>
              <span>Ù…Ø¤Ø´Ø±Ø§Øª Ø³Ø±ÙŠØ¹Ø©</span>
            </h3>
            <div class="grid grid-cols-2 gap-4">
              <div class="glass rounded-xl p-4 text-center">
                <div class="opacity-70 text-xs mb-2">Ø§Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ù†Ø´Ø·ÙˆÙ†</div>
                <div id="metric_active" class="text-3xl font-extrabold gold">â€”</div>
              </div>
              <div class="glass rounded-xl p-4 text-center">
                <div class="opacity-70 text-xs mb-2">Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø§Ù„ØµÙØ­Ø©</div>
                <div id="metric_views" class="text-3xl font-extrabold gold">â€”</div>
              </div>
              <div class="glass rounded-xl p-4 text-center">
                <div class="opacity-70 text-xs mb-2">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ø¬Ø¯Ø¯</div>
                <div id="metric_new" class="text-3xl font-extrabold gold">â€”</div>
              </div>
              <div class="glass rounded-xl p-4 text-center">
                <div class="opacity-70 text-xs mb-2">Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</div>
                <div id="metric_cities" class="text-3xl font-extrabold gold">â€”</div>
              </div>
            </div>
            <div class="mt-4 p-3 rounded-xl bg-yellow-500/10 border border-yellow-500/20">
              <p class="text-xs opacity-80">âš ï¸ Ø¹Ø±Ø¶ ØªØ¬Ø±ÙŠØ¨ÙŠ â€” Ø§Ø±Ø¨Ø· Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø¨ÙˆØ§Ø¬Ù‡Ø© GA4 API Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­ÙŠØ©.</p>
            </div>
          </div>
        </div>
      </section>

      <section id="view-settings" class="view hidden space-y-4">
        <div class="grid md:grid-cols-2 gap-4">
          <div class="card glass rounded-2xl p-6">
            <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
              <span>ğŸ”’</span>
              <span>Ø­Ù…Ø§ÙŠØ© Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
            </h3>
            <label class="text-sm opacity-80 block mb-2">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</label>
            <input id="admin_pass" type="password" class="w-full mb-3 px-4 py-3 rounded-xl input-field" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©"/>
            <button id="setPass" class="btn w-full py-3 rounded-xl">ğŸ” Ø­ÙØ¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</button>
            <div class="mt-3 p-3 rounded-xl bg-red-500/10 border border-red-500/20">
              <p class="text-xs opacity-80">âš ï¸ ØªÙØ®Ø²Ù† Ù…Ø­Ù„ÙŠÙ‹Ø§ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­. Ù„Ø§ ØªØ´Ø§Ø±ÙƒÙ‡Ø§ Ù…Ø¹ Ø£Ø­Ø¯.</p>
            </div>
          </div>
          
          <div class="card glass rounded-2xl p-6">
            <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
              <span>ğŸ”¥</span>
              <span>Firebase (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</span>
            </h3>
            <p class="text-sm opacity-80 mb-3">Ù„Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©ØŒ Ø¶Ø¹ Ù…ÙØ§ØªÙŠØ­ Firebase:</p>
            <textarea id="firebase_json" rows="8" class="w-full px-4 py-3 rounded-xl input-field font-mono text-xs" placeholder='{
  "apiKey":"...",
  "authDomain":"...",
  "projectId":"...",
  "storageBucket":"...",
  "messagingSenderId":"...",
  "appId":"..."
}'></textarea>
            <div class="flex gap-2 mt-3">
              <button id="initFirebase" class="btn flex-1 py-3 rounded-xl">ØªÙ‡ÙŠØ¦Ø© Firebase</button>
              <button id="syncNow" class="btn-secondary flex-1 py-3 rounded-xl">â¤´ï¸ Ù…Ø²Ø§Ù…Ù†Ø©</button>
            </div>
            <div class="mt-3 p-3 rounded-xl bg-blue-500/10 border border-blue-500/20">
              <p class="text-xs opacity-80">ğŸ’¡ Ø¥Ù† Ù„Ù… ØªØ¶Ø¹ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ØŒ ØªØ¸Ù„ Ø§Ù„Ù„ÙˆØ­Ø© ØªØ¹Ù…Ù„ Ù…Ø­Ù„ÙŠÙ‹Ø§.</p>
            </div>
          </div>
        </div>
      </section>

    </main>
  </div>

  <script>
  /************** Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© **************/
  const DEFAULT_DATA = {
    hero: {
      title: "Ù…Ù†Ø¸ÙˆÙ…Ø© Bawou Market â€” Ø§Ù„Ø¨ÙŠØª Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ Ø§Ù„ÙØ§Ø®Ø±",
      desc: "ÙŠØ¬Ù…Ø¹ ÙƒÙ„ ÙØ±ÙˆØ¹ Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯: Sandwich Bawou, Bawou Metal, Bawou Mina, Loupeur...",
      cta1: { text: "Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø£Ø±ÙƒØ§Ù†", link: "#branches" },
      cta2: { text: "Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø¹Ø±ÙˆØ¶", link: "#offers" },
      madeIn: { enabled: true, text: "ØµÙ†Ø¹ Ø¨ÙØ®Ø± ÙÙŠ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± ğŸ‡©ğŸ‡¿" }
    },
    branches: [
      { id: cryptoId(), emoji:"ğŸ”", key:"sandwich", title:"Sandwich Bawou", desc:"ÙˆØ¬Ø¨Ø§Øª Ø´Ø¨Ø§Ø¨ÙŠØ© ÙØ§Ø®Ø±Ø© â€” Ø£Ø³Ø±Ø¹ â€“ Ø£Ù„Ø°", price:15 },
      { id: cryptoId(), emoji:"ğŸ”¥", key:"metal", title:"Bawou Metal", desc:"Ø´ÙˆØ§ÙŠØ§Øª ÙˆÙ…Ø¹Ø¯Ù‘Ø§Øª Ù…Ø¹Ø¯Ù†ÙŠØ© Ù…Ø®ØµØµØ© â€” ØµÙ†Ø¹ Ø¬Ø²Ø§Ø¦Ø±ÙŠ", price:50 },
      { id: cryptoId(), emoji:"ğŸ‘—", key:"mina", title:"Bawou Mina", desc:"Ø£Ø²ÙŠØ§Ø¡ Ù†Ø³Ø§Ø¦ÙŠØ© Ø±Ø§Ù‚ÙŠØ© â€“ Ø£Ø°ÙˆØ§Ù‚ Ù…ØªØ¹Ø¯Ø¯Ø©", price:29 },
      { id: cryptoId(), emoji:"ğŸ¯", key:"loupeur", title:"Bawou Loupeur", desc:"Ø¹Ø³Ù„ ÙØ§Ø®Ø± Ù„Ù„Ø£Ø²ÙˆØ§Ø¬ â€“ ØµÙ†Ø¹ ÙÙŠ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±", price:12 },
      { id: cryptoId(), emoji:"ğŸšš", key:"jibm3ak", title:"Bawou Jib M3ak", desc:"ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹ â€“ Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Bip Bip", price:0 }
    ],
    prices:[
      { id: cryptoId(), branch:"Sandwich Bawou", name:"Burger Mixte", price:4, note:"Ù‚Ø±ÙŠØ¨Ù‹Ø§" },
      { id: cryptoId(), branch:"Sandwich Bawou", name:"Tacos Viande HachÃ©e", price:5, note:"" },
      { id: cryptoId(), branch:"Bawou Metal", name:"Grill mural 60cm", price:120, note:"Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨" }
    ],
    media: [],
    embeds: { looker: "" },
    metrics: { active:0, views:0, new:0, cities:0 },
    lastUpdated: Date.now()
  }

  const ADMIN_PASSWORD = localStorage.getItem('bawou_admin_pass') || 'bawou-2025';

  /************** ØªØ®Ø²ÙŠÙ† **************/
  function loadData(){
    try{ 
      const data = JSON.parse(localStorage.getItem('bawou_admin_data'));
      return data || DEFAULT_DATA;
    }catch(e){ 
      return DEFAULT_DATA;
    }
  }
  
  function saveData(data){
    data.lastUpdated = Date.now();
    localStorage.setItem('bawou_admin_data', JSON.stringify(data));
    updateStats();
  }

  let state = loadData();

  /************** Toast Notifications **************/
  function showToast(message, type = 'success'){
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.className = `toast ${type}`;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 3000);
  }

  /************** Auth **************/
  const authEl = document.getElementById('auth');
  const loginBtn = document.getElementById('loginBtn');
  const pwdInput = document.getElementById('pwd');
  
  pwdInput.addEventListener('keypress', (e) => {
    if(e.key === 'Enter') loginBtn.click();
  });
  
  loginBtn.onclick = () => {
    const val = pwdInput.value.trim();
    if(!val){
      showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±', 'error');
      return;
    }
    const ok = val === (localStorage.getItem('bawou_admin_pass') || ADMIN_PASSWORD);
    if(ok){
      if(document.getElementById('remember').checked){ 
        sessionStorage.setItem('bawou_admin_logged','1');
      }
      authEl.style.display='none';
      showToast('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…! ğŸ‰', 'success');
    }else{
      showToast('ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙŠØ± ØµØ­ÙŠØ­Ø© âŒ', 'error');
      pwdInput.value = '';
      pwdInput.focus();
    }
  }
  
  if(sessionStorage.getItem('bawou_admin_logged')==='1'){ 
    authEl.style.display='none';
  }

  /************** Mobile Menu **************/
  const mobileMenuBtn = document.getElementById('mobileMenuBtn');
  const sidebar = document.getElementById('sidebar');
  
  mobileMenuBtn.onclick = () => {
    sidebar.classList.toggle('open');
  };

  /************** Router **************/
  const routes = ['home','branches','prices','media','analytics','settings'];
  const links = document.querySelectorAll('.sidebar a');
  
  links.forEach(a => {
    a.onclick = (e) => {
      e.preventDefault();
      go(a.dataset.route);
      // Close mobile menu after navigation
      sidebar.classList.remove('open');
    }
  });
  
  function go(name){
    document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
    const view = document.getElementById('view-'+name);
    if(view) view.classList.remove('hidden');
    
    links.forEach(a => a.classList.toggle('active', a.dataset.route===name));
    
    if(name==='branches') renderBranches();
    if(name==='prices') renderPrices();
    if(name==='media') renderMedia();
    if(name==='home') fillHomeForm();
    if(name==='analytics') initEmbed();
  }
  
  go('home');

  /************** Stats Update **************/
  function updateStats(){
    document.getElementById('stat-branches').textContent = state.branches.length;
    document.getElementById('stat-products').textContent = state.prices.length;
    document.getElementById('stat-media').textContent = state.media.length;
    
    const lastUpdate = new Date(state.lastUpdated || Date.now());
    const timeStr = lastUpdate.toLocaleTimeString('ar-DZ', {hour: '2-digit', minute:'2-digit'});
    document.getElementById('stat-updated').textContent = timeStr;
  }
  
  updateStats();

  /************** Home Form **************/
  function fillHomeForm(){
    const h = state.hero;
    setVal('hero_title', h.title);
    setVal('hero_desc', h.desc);
    setVal('cta1_text', h.cta1.text);
    setVal('cta1_link', h.cta1.link);
    setVal('cta2_text', h.cta2.text);
    setVal('cta2_link', h.cta2.link);
    setVal('madein_text', h.madeIn.text);
    document.getElementById('madein_dz').value = String(h.madeIn.enabled);
  }

  function setVal(id, v){ 
    const el = document.getElementById(id);
    if(el) el.value = v || '';
  }
  
  function getVal(id){ 
    return document.getElementById(id).value;
  }

  document.getElementById('saveAll').onclick = () => {
    try{
      state.hero.title = getVal('hero_title');
      state.hero.desc = getVal('hero_desc');
      state.hero.cta1.text = getVal('cta1_text');
      state.hero.cta1.link = getVal('cta1_link');
      state.hero.cta2.text = getVal('cta2_text');
      state.hero.cta2.link = getVal('cta2_link');
      state.hero.madeIn.enabled = document.getElementById('madein_dz').value==='true';
      state.hero.madeIn.text = getVal('madein_text');
      
      saveData(state);
      showToast('âœ”ï¸ ØªÙ… Ø­ÙØ¸ ÙƒÙ„ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
    }catch(e){
      showToast('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸', 'error');
    }
  }

  /************** Branches **************/
  const branchesList = document.getElementById('branchesList');
  
  function renderBranches(){
    branchesList.innerHTML = '';
    
    if(state.branches.length === 0){
      branchesList.innerHTML = '<div class="col-span-full text-center p-8 glass rounded-2xl"><p class="opacity-70">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø±ÙƒØ§Ù† Ø­Ø§Ù„ÙŠØ§Ù‹. Ø§Ø¶ØºØ· "Ø¥Ø¶Ø§ÙØ© Ø±ÙƒÙ†" Ù„Ù„Ø¨Ø¯Ø¡.</p></div>';
      return;
    }
    
    state.branches.forEach((b,i) => {
      const el = document.createElement('div');
      el.className='card glass rounded-2xl p-5 space-y-3';
      el.innerHTML = `
        <div class="flex items-center justify-between">
          <div class="text-2xl flex items-center gap-2">
            <span>${b.emoji}</span>
            <span class="font-bold text-lg">${escapeHtml(b.title)}</span>
          </div>
          <div class="flex gap-2">
            <button class="px-2 py-1 rounded-lg glass border border-white/10 hover:bg-white/10 text-sm" data-act="up" title="ØªØ­Ø±ÙŠÙƒ Ù„Ù„Ø£Ø¹Ù„Ù‰">â¬†ï¸</button>
            <button class="px-2 py-1 rounded-lg glass border border-white/10 hover:bg-white/10 text-sm" data-act="down" title="ØªØ­Ø±ÙŠÙƒ Ù„Ù„Ø£Ø³ÙÙ„">â¬‡ï¸</button>
            <button class="px-2 py-1 rounded-lg btn-danger text-sm" data-act="del">ğŸ—‘ï¸</button>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="text-xs opacity-70 block mb-1">Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ</label>
            <input data-f="emoji" class="w-full px-3 py-2 rounded-lg input-field text-center text-xl" value="${b.emoji}" maxlength="2">
          </div>
          <div>
            <label class="text-xs opacity-70 block mb-1">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
            <input data-f="title" class="w-full px-3 py-2 rounded-lg input-field" value="${escapeHtml(b.title)}">
          </div>
          <div class="col-span-2">
            <label class="text-xs opacity-70 block mb-1">Ø§Ù„ÙˆØµÙ</label>
            <textarea data-f="desc" rows="2" class="w-full px-3 py-2 rounded-lg input-field">${escapeHtml(b.desc)}</textarea>
          </div>
          <div>
            <label class="text-xs opacity-70 block mb-1">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</label>
            <input data-f="price" type="number" step="0.01" class="w-full px-3 py-2 rounded-lg input-field" value="${b.price}">
          </div>
          <div>
            <label class="text-xs opacity-70 block mb-1">Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±ÙŠØ¯</label>
            <input data-f="key" class="w-full px-3 py-2 rounded-lg input-field" value="${b.key || ''}">
          </div>
        </div>`;
      
      el.querySelectorAll('input,textarea').forEach(inp => {
        inp.oninput = () => { 
          b[inp.dataset.f] = (inp.type==='number') ? Number(inp.value) : inp.value;
          saveData(state);
        }
      });
      
      el.querySelector('[data-act="del"]').onclick = () => { 
        if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø±ÙƒÙ†ØŸ')){
          state.branches.splice(i,1);
          saveData(state);
          renderBranches();
          showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø±ÙƒÙ†', 'success');
        }
      }
      
      el.querySelector('[data-act="up"]').onclick = () => { 
        if(i>0){
          [state.branches[i-1], state.branches[i]] = [state.branches[i], state.branches[i-1]];
          saveData(state);
          renderBranches();
          showToast('ØªÙ… ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø±ÙƒÙ† Ù„Ù„Ø£Ø¹Ù„Ù‰', 'success');
        }
      }
      
      el.querySelector('[data-act="down"]').onclick = () => { 
        if(i < state.branches.length-1){
          [state.branches[i+1], state.branches[i]] = [state.branches[i], state.branches[i+1]];
          saveData(state);
          renderBranches();
          showToast('ØªÙ… ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø±ÙƒÙ† Ù„Ù„Ø£Ø³ÙÙ„', 'success');
        }
      }
      
      branchesList.appendChild(el);
    });
  }
  
  document.getElementById('addBranch').onclick = () => {
    state.branches.push({
      id: cryptoId(),
      emoji: 'âœ¨',
      key: 'new-' + cryptoId(),
      title: 'Ø±ÙƒÙ† Ø¬Ø¯ÙŠØ¯',
      desc: 'Ø£Ø¶Ù ÙˆØµÙØ§Ù‹ Ù‚ØµÙŠØ±Ø§Ù‹ Ù‡Ù†Ø§',
      price: 0
    });
    saveData(state);
    renderBranches();
    showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø±ÙƒÙ† Ø¬Ø¯ÙŠØ¯', 'success');
  }

  /************** Prices **************/
  const priceRows = document.getElementById('priceRows');
  
  function renderPrices(){
    priceRows.innerHTML='';
    
    if(state.prices.length === 0){
      priceRows.innerHTML = '<tr><td colspan="5" class="text-center py-8 opacity-70">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª. Ø§Ø¶ØºØ· "Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬" Ù„Ù„Ø¨Ø¯Ø¡.</td></tr>';
      return;
    }
    
    state.prices.forEach((p,i) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td class="py-3"><input data-f="branch" class="w-full px-3 py-2 rounded-lg input-field" value="${escapeHtml(p.branch)}"></td>
        <td class="py-3"><input data-f="name" class="w-full px-3 py-2 rounded-lg input-field" value="${escapeHtml(p.name)}"></td>
        <td class="py-3"><input data-f="price" type="number" step="0.01" class="w-28 px-3 py-2 rounded-lg input-field" value="${p.price}"></td>
        <td class="py-3"><input data-f="note" class="w-full px-3 py-2 rounded-lg input-field" value="${escapeHtml(p.note||'')}"></td>
        <td class="py-3 text-center">
          <button class="px-3 py-1 rounded-lg btn-danger text-sm" data-act="del">Ø­Ø°Ù</button>
        </td>`;
      
      tr.querySelectorAll('input').forEach(inp => {
        inp.oninput = () => { 
          p[inp.dataset.f] = (inp.type==='number') ? Number(inp.value) : inp.value;
          saveData(state);
        }
      });
      
      tr.querySelector('[data-act="del"]').onclick = () => { 
        if(confirm('Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ')){
          state.prices.splice(i,1);
          saveData(state);
          renderPrices();
          showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬', 'success');
        }
      }
      
      priceRows.appendChild(tr);
    });
  }
  
  document.getElementById('addPrice').onclick = () => {
    state.prices.push({
      id: cryptoId(),
      branch: 'Sandwich Bawou',
      name: 'Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯',
      price: 0,
      note: ''
    });
    saveData(state);
    renderPrices();
    showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯', 'success');
  }

  /************** Media **************/
  const imageInput = document.getElementById('imageInput');
  const preview = document.getElementById('preview');
  const mediaGrid = document.getElementById('mediaGrid');
  const dropZone = document.getElementById('dropZone');
  
  // Click to upload
  dropZone.onclick = () => imageInput.click();
  
  // Drag and drop
  dropZone.ondragover = (e) => {
    e.preventDefault();
    dropZone.style.borderColor = 'var(--gold)';
  };
  
  dropZone.ondragleave = () => {
    dropZone.style.borderColor = '';
  };
  
  dropZone.ondrop = (e) => {
    e.preventDefault();
    dropZone.style.borderColor = '';
    const file = e.dataTransfer.files[0];
    if(file && file.type.startsWith('image/')) {
      handleImageUpload(file);
    }
  };
  
  imageInput.onchange = (e) => {
    const file = e.target.files[0];
    if(file) handleImageUpload(file);
  }
  
  function handleImageUpload(file){
    if(file.size > 5 * 1024 * 1024){
      showToast('Ø§Ù„ØµÙˆØ±Ø© ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 5MB)', 'error');
      return;
    }
    
    const reader = new FileReader();
    reader.onload = () => {
      preview.src = reader.result;
      preview.classList.remove('hidden');
      
      state.media.push({
        id: cryptoId(),
        dataUrl: reader.result,
        name: file.name,
        size: file.size,
        uploadedAt: Date.now()
      });
      
      saveData(state);
      renderMedia();
      showToast('ØªÙ… Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­ âœ“', 'success');
    }
    reader.readAsDataURL(file);
  }
  
  function renderMedia(){
    mediaGrid.innerHTML = '';
    document.getElementById('mediaCount').textContent = state.media.length;
    
    if(state.media.length === 0){
      mediaGrid.innerHTML = '<div class="col-span-full text-center p-4 opacity-70 text-sm">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±</div>';
      return;
    }
    
    state.media.forEach((m,i) => {
      const d = document.createElement('div');
      d.className = 'relative group';
      d.innerHTML = `
        <img src="${m.dataUrl}" class="w-full aspect-square object-cover rounded-xl border border-white/10 cursor-pointer hover:border-gold/50 transition-all" title="${m.name}"/>
        <button class='absolute top-2 left-2 bg-red-600/90 hover:bg-red-600 px-2 py-1 rounded-lg text-xs opacity-0 group-hover:opacity-100 transition-opacity' data-i='${i}'>ğŸ—‘ï¸</button>
        <div class="absolute bottom-2 left-2 right-2 bg-black/80 px-2 py-1 rounded text-xs truncate opacity-0 group-hover:opacity-100 transition-opacity">${m.name}</div>
      `;
      
      d.querySelector('img').onclick = () => {
        window.open(m.dataUrl, '_blank');
      };
      
      d.querySelector('button').onclick = (e) => {
        e.stopPropagation();
        if(confirm('Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„ØµÙˆØ±Ø©ØŸ')){
          state.media.splice(i,1);
          saveData(state);
          renderMedia();
          showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„ØµÙˆØ±Ø©', 'success');
        }
      }
      
      mediaGrid.appendChild(d);
    });
  }

  /************** Analytics Embed **************/
  function initEmbed(){
    const v = state.embeds.looker || '';
    const inp = document.getElementById('looker_embed');
    inp.value = v;
    
    const wrap = document.getElementById('embedWrap');
    const loadBtn = document.getElementById('loadEmbed');
    
    loadBtn.onclick = () => {
      const url = inp.value.trim();
      if(url){
        state.embeds.looker = url;
        saveData(state);
        wrap.classList.remove('hidden');
        document.getElementById('embedFrame').src = url;
        showToast('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Analytics', 'success');
      }else{
        showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· ØµØ­ÙŠØ­', 'error');
      }
    };
    
    if(v){
      wrap.classList.remove('hidden');
      document.getElementById('embedFrame').src = v;
    }
  }

  /************** Export / Import **************/
  document.getElementById('exportBtn').onclick = () => {
    try{
      const dataStr = JSON.stringify(state, null, 2);
      const blob = new Blob([dataStr], {type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `bawou-backup-${new Date().toISOString().slice(0,10)}.json`;
      a.click();
      showToast('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© âœ“', 'success');
    }catch(e){
      showToast('ÙØ´Ù„ Ø§Ù„ØªØµØ¯ÙŠØ± âŒ', 'error');
    }
  }
  
  document.getElementById('importFile').onchange = (e) => {
    const file = e.target.files[0];
    if(!file) return;
    
    const r = new FileReader();
    r.onload = () => {
      try{
        const imported = JSON.parse(r.result);
        if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©.')){
          state = imported;
          saveData(state);
          showToast('ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­ âœ“', 'success');
          setTimeout(() => location.reload(), 1500);
        }
      }catch(err){
        showToast('Ù…Ù„Ù JSON ØºÙŠØ± ØµØ§Ù„Ø­ âŒ', 'error');
      }
    };
    r.readAsText(file);
  }

  /************** Settings **************/
  document.getElementById('setPass').onclick = () => {
    const v = document.getElementById('admin_pass').value.trim();
    if(v.length < 6){
      showToast('ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
      return;
    }
    localStorage.setItem('bawou_admin_pass', v);
    showToast('âœ“ ØªÙ… ØªØ­Ø¯ÙŠØ« ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø¨Ù†Ø¬Ø§Ø­', 'success');
    document.getElementById('admin_pass').value = '';
  }

  document.getElementById('initFirebase').onclick = () => {
    try{
      const cfg = JSON.parse(document.getElementById('firebase_json').value);
      if(!cfg.apiKey || !cfg.projectId){
        throw new Error('Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ÙƒØ§Ù…Ù„Ø©');
      }
      window.bawouFirebaseCfg = cfg;
      showToast('âœ”ï¸ ØªÙ… Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase', 'success');
    }catch(e){
      showToast('ØµÙŠØºØ© JSON ØºÙŠØ± ØµØ­ÙŠØ­Ø© Ø£Ùˆ Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©', 'error');
    }
  }
  
  document.getElementById('syncNow').onclick = () => {
    if(!window.bawouFirebaseCfg){
      showToast('Ø£Ø¯Ø®Ù„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase ÙˆÙØ¹Ù‘Ù„Ù‡Ø§ Ø£ÙˆÙ„Ø§Ù‹', 'error');
      return;
    }
    showToast('Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ± - Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ Ø­Ø§Ù„ÙŠØ§Ù‹', 'success');
  }

  /************** Utils **************/
  function cryptoId(){
    return 'id_' + Math.random().toString(36).slice(2,11);
  }
  
  function escapeHtml(s){
    if(!s) return '';
    return String(s)
      .replace(/&/g,'&amp;')
      .replace(/</g,'&lt;')
      .replace(/>/g,'&gt;')
      .replace(/"/g,'&quot;')
      .replace(/'/g,'&#039;');
  }

  /************** ØªÙ‡ÙŠØ¦Ø© Ø£ÙˆÙ„ÙŠØ© **************/
  fillHomeForm();
  renderMedia();
  
  // Auto-save indicator (optional)
  let saveTimeout;
  const originalSaveData = saveData;
  saveData = function(data){
    clearTimeout(saveTimeout);
    saveTimeout = setTimeout(() => {
      originalSaveData(data);
    }, 500);
  }
  
  console.log('âœ¨ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Bawou Market Ø¬Ø§Ù‡Ø²Ø©!');
  console.log('ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:', {
    branches: state.branches.length,
    products: state.prices.length,
    media: state.media.length
  });
  </script>
</body>
</html>